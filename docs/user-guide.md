# Руководство пользователя

## Введение

Excel Merger - это Desktop приложение для объединения нескольких Excel файлов с одинаковой структурой в один файл. Приложение использует принцип шаблонного объединения: вы выбираете базовый файл, настраиваете правила, и все остальные файлы объединяются по этим правилам.

## Основные возможности

✓ Объединение нескольких Excel файлов (.xlsx) в один
✓ Гибкая настройка правил для каждого листа
✓ Поддержка разных строк заголовков в разных листах
✓ Предпросмотр результата перед сохранением
✓ Сохранение и загрузка профилей настроек
✓ Drag & Drop интерфейс

## Быстрый старт

### Шаг 1: Выбор базового файла

1. Запустите приложение
2. Нажмите кнопку **"Выбрать базовый файл"**
3. Выберите один из ваших Excel файлов

После выбора файла вы увидите список всех листов из этого файла.

### Шаг 2: Настройка правил

Для каждого листа настройте:

**2.1. Включение/выключение обработки**
- Поставьте галочку рядом с листом, который нужно обработать
- Снимите галочку с листов, которые нужно исключить

**2.2. Номер строки с заголовками**
- Укажите, в какой строке находятся заголовки столбцов
- По умолчанию: строка 1
- Примеры:
  - Если заголовки в первой строке: введите `1`
  - Если есть шапка и заголовки во второй строке: введите `2`

**2.3. Предпросмотр заголовков**
- После указания номера строки нажмите "Показать заголовки"
- Проверьте, что отображаются правильные названия столбцов

**2.4. Сохранение профиля (опционально)**
- Нажмите "Сохранить профиль"
- Введите имя профиля (например, "Квартальные отчеты")
- В следующий раз можно будет загрузить эти настройки

### Шаг 3: Добавление файлов

Добавьте файлы для объединения одним из способов:

**Способ 1: Drag & Drop**
- Перетащите Excel файлы в область "Перетащите файлы сюда"

**Способ 2: Кнопка "Добавить"**
- Нажмите кнопку "Добавить файлы"
- Выберите один или несколько файлов
- Нажмите "Открыть"

**Управление списком файлов:**
- Для удаления: выберите файл и нажмите "Удалить"
- Для очистки всего списка: нажмите "Очистить все"

### Шаг 4: Объединение

1. Нажмите кнопку **"Объединить"**
2. Дождитесь завершения процесса (следите за прогресс-баром)
3. Просмотрите результат в таблице предпросмотра

### Шаг 5: Сохранение результата

1. Нажмите кнопку **"Сохранить как..."**
2. Выберите папку и введите имя файла
3. Нажмите "Сохранить"

Готово! Ваш объединенный файл сохранен.

## Детальное описание функций

### Настройка строки заголовков

**Что это значит?**

Номер строки, в которой находятся названия столбцов.

**Примеры:**

**Пример 1: Заголовки в первой строке**
```
| Дата       | Товар  | Количество | Сумма |  ← строка 1 (заголовки)
|------------|--------|------------|-------|
| 2024-01-15 | Товар1 | 10         | 1000  |  ← строка 2 (данные)
| 2024-01-20 | Товар2 | 5          | 500   |  ← строка 3 (данные)
```
**Настройка:** Номер строки с заголовками = `1`

**Пример 2: Заголовки во второй строке**
```
Отчет о продажах за Январь 2024             ← строка 1 (шапка)
| Дата       | Товар  | Количество | Сумма | ← строка 2 (заголовки)
|------------|--------|------------|-------|
| 2024-01-15 | Товар1 | 10         | 1000  | ← строка 3 (данные)
```
**Настройка:** Номер строки с заголовками = `2`

**Пример 3: Заголовки в третьей строке**
```
ООО "Компания"                               ← строка 1
Отчет о продажах за Январь 2024             ← строка 2
| Дата       | Товар  | Количество | Сумма | ← строка 3 (заголовки)
|------------|--------|------------|-------|
| 2024-01-15 | Товар1 | 10         | 1000  | ← строка 4 (данные)
```
**Настройка:** Номер строки с заголовками = `3`

### Работа с профилями

**Сохранение профиля:**
1. Настройте все листы
2. Нажмите "Сохранить профиль"
3. Введите имя (например, "Продажи 2024")
4. Профиль сохранится в папке `configs/`

**Загрузка профиля:**
1. Нажмите "Загрузить профиль"
2. Выберите сохраненный профиль
3. Все настройки применятся автоматически

**Когда использовать профили:**
- Вы регулярно объединяете файлы с одинаковой структурой
- Вы хотите сэкономить время на настройке
- Вам нужно повторить объединение с теми же параметрами

## Типичные сценарии использования

### Сценарий 1: Объединение квартальных отчетов

**Задача:** Объединить отчеты о продажах за 4 квартала в один файл

**Файлы:**
- `sales_Q1_2024.xlsx` (базовый)
- `sales_Q2_2024.xlsx`
- `sales_Q3_2024.xlsx`
- `sales_Q4_2024.xlsx`

**Структура каждого файла:**
- Лист "Продажи" - заголовки в строке 1
- Лист "Возвраты" - заголовки в строке 1

**Действия:**
1. Выбрать `sales_Q1_2024.xlsx` как базовый
2. Настроить оба листа (заголовки в строке 1)
3. Сохранить профиль "Квартальные продажи"
4. Добавить остальные 3 файла
5. Объединить и сохранить как `sales_2024_full.xlsx`

**Результат:**
- Лист "Продажи": данные из всех 4 кварталов
- Лист "Возвраты": данные из всех 4 кварталов

### Сценарий 2: Объединение отчетов с разными заголовками

**Задача:** Объединить отчеты, где в разных листах заголовки на разных строках

**Файл:** `monthly_report.xlsx`
- Лист "Продажи" - заголовки в строке 1
- Лист "Детали" - заголовки в строке 3 (первые 2 строки - шапка)
- Лист "Сводка" - не нужен

**Действия:**
1. Выбрать базовый файл
2. Настроить листы:
   - ☑ Продажи, строка 1
   - ☑ Детали, строка 3
   - ☐ Сводка (убрать галочку)
3. Добавить остальные файлы
4. Объединить

### Сценарий 3: Объединение отчетов филиалов

**Задача:** Собрать отчеты от 10 филиалов в единый файл

**Файлы:**
- `branch_01.xlsx`, `branch_02.xlsx`, ..., `branch_10.xlsx`

**Действия:**
1. Выбрать `branch_01.xlsx` как базовый
2. Настроить правила
3. Добавить сразу все остальные файлы (Ctrl+A при выборе)
4. Объединить
5. Сохранить как `all_branches_report.xlsx`

## Советы и рекомендации

### ✓ Лучшие практики

1. **Проверяйте заголовки**
   - Всегда используйте предпросмотр заголовков
   - Убедитесь, что названия столбцов правильные

2. **Используйте профили**
   - Создавайте профили для повторяющихся задач
   - Давайте понятные имена профилям

3. **Проверяйте предпросмотр**
   - Перед сохранением просмотрите первые строки
   - Убедитесь, что данные объединились правильно

4. **Называйте файлы понятно**
   - Результат: `sales_2024_merged.xlsx`
   - Не: `result.xlsx`, `output.xlsx`

### ⚠ Частые ошибки

1. **Неправильный номер строки заголовков**
   - Симптом: в результате странные данные или пропущены строки
   - Решение: проверьте предпросмотр заголовков

2. **Забыли снять галочку с ненужного листа**
   - Симптом: в результате есть лишние листы
   - Решение: проверьте настройки перед объединением

3. **Разная структура файлов**
   - Симптом: в результате пропущены данные или NaN
   - Решение: убедитесь, что все файлы имеют одинаковые столбцы

## Ограничения

- Поддержка только формата .xlsx (Excel 2007+)
- Рекомендуемый максимальный размер файла: 100 MB
- Рекомендуемое количество файлов: до 100
- Структура столбцов должна быть одинаковой во всех файлах

## Устранение неполадок

### Проблема: Приложение не открывает файл

**Причины:**
- Файл поврежден
- Файл открыт в Excel
- Недостаточно прав доступа

**Решение:**
- Закройте файл в Excel
- Проверьте, что файл не поврежден
- Проверьте права доступа к файлу

### Проблема: В результате отсутствуют некоторые данные

**Причины:**
- Неправильно указан номер строки заголовков
- Лист отсутствует в некоторых файлах
- Разная структура столбцов

**Решение:**
- Проверьте настройку строки заголовков
- Посмотрите логи (файл `excel_merger.log`)
- Убедитесь, что все файлы имеют нужный лист

### Проблема: Результат содержит пустые ячейки (NaN)

**Причины:**
- В исходных файлах были пустые ячейки
- Разное количество столбцов в файлах

**Решение:**
- Это нормально, если данные отсутствовали
- Проверьте исходные файлы

## Обратная связь

Если вы нашли ошибку или хотите предложить улучшение, пожалуйста:
1. Опишите проблему
2. Приложите файл `excel_merger.log`
3. Укажите версию приложения

## Горячие клавиши

- `Ctrl+O` - Открыть базовый файл
- `Ctrl+S` - Сохранить результат
- `Ctrl+P` - Сохранить профиль
- `Ctrl+L` - Загрузить профиль
- `F5` - Обновить предпросмотр
- `Escape` - Отмена текущей операции
