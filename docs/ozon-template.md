# Шаблон Ozon

## Описание

Встроенный предустановленный шаблон для работы с файлами Ozon. Автоматически настраивает листы согласно структуре Ozon-файлов.

## Настройки шаблона

### Включенные листы
1. **Шаблон** - строка заголовков: 4
2. **Озон.Видео** - строка заголовков: 4
3. **Озон.Видеообложка** - строка заголовков: 4

### Остальные листы
Все остальные листы в файле будут **отключены** по умолчанию.

## Использование

### По умолчанию
При первом запуске приложения шаблон Ozon **включен** автоматически.

### Включение/отключение
На вкладке **"1. Базовый файл"** есть чекбокс:
```
☑ Использовать шаблон Ozon (листы: Шаблон, Озон.Видео, Озон.Видеообложка с заголовками на строке 4)
```

- **Установлен** - шаблон применяется при загрузке Excel-файла
- **Снят** - шаблон не применяется, все листы настраиваются вручную

### Применение к уже загруженному файлу
1. Загрузите Excel-файл
2. Установите/снимите чекбокс "Использовать шаблон Ozon"
3. Настройки автоматически применятся к текущим листам

## Сохранение настройки

Состояние чекбокса сохраняется в файл:
```
~/.excel-merger/configs/settings.json
```

При следующем запуске программы чекбокс будет в том же состоянии.

## Изменение настройки по умолчанию

Чтобы по умолчанию шаблон был **выключен**:
1. Снимите чекбокс в интерфейсе
2. Настройка автоматически сохранится
3. При следующем запуске шаблон будет выключен

## Файл настроек

`~/.excel-merger/configs/settings.json`:
```json
{
  "use_ozon_template": true,
  "version": "1.0"
}
```

### Параметры
- `use_ozon_template` - использовать шаблон Ozon (`true`/`false`)
- `version` - версия формата настроек

## Технические детали

### Реализация
- **Файл**: `internal/config/manager.go`
- **Метод**: `GetOzonTemplate()`
- **Структура**: `AppSettings`

### Шаблон определен как:
```go
map[string]core.SheetConfig{
    "Шаблон": {
        SheetName: "Шаблон",
        Enabled:   true,
        HeaderRow: 4,
    },
    "Озон.Видео": {
        SheetName: "Озон.Видео",
        Enabled:   true,
        HeaderRow: 4,
    },
    "Озон.Видеообложка": {
        SheetName: "Озон.Видеообложка",
        Enabled:   true,
        HeaderRow: 4,
    },
}
```

## Workflow

### С включенным шаблоном
1. Открыть базовый файл Excel
2. **Автоматически**: листы "Шаблон", "Озон.Видео", "Озон.Видеообложка" включены с HeaderRow=4
3. Остальные листы выключены
4. При необходимости можно вручную настроить любой лист

### С выключенным шаблоном
1. Открыть базовый файл Excel
2. Все листы выключены по умолчанию
3. Настройка каждого листа производится вручную

## Преимущества

✅ Экономия времени при работе с Ozon-файлами  
✅ Одним кликом настраиваются нужные листы  
✅ Можно легко отключить при необходимости  
✅ Настройка сохраняется между запусками  
✅ Не мешает работе с другими типами файлов  

## Расширение

Для добавления других шаблонов (например, Wildberries, Яндекс.Маркет):
1. Добавить метод `GetWildberriesTemplate()` в `config/manager.go`
2. Добавить соответствующий чекбокс в UI
3. Сохранить настройку в `AppSettings`
