# Тестовые данные

## Расположение
`/testdata/`

## Файлы

| Файл | Формат | Размер | Описание |
|------|--------|--------|----------|
| Повседневная обувь_04.11.2025.xlsx | .xlsx | - | Тестовый файл 1 |
| Повседневная обувь_04.11.2025 (1).xlsx | .xlsx | - | Тестовый файл 2 |

## Структура файлов

### Шапка (строки 1-4)
Первые 4 строки содержат заголовочную информацию (название отчета, даты, и т.д.)

### Заголовки (строка 3)
**Строка 3** содержит названия столбцов (заголовки таблицы)

### Данные (строки 5+)
С **строки 5** и далее начинаются фактические данные для объединения

## Использование в тестах

### Настройка конфигурации
При тестировании используйте следующую конфигурацию:

```go
config := &core.SheetConfig{
    SheetName: "Шаблон",  // или фактическое имя листа
    HeaderRow: 4,          // Заголовки в 4-й строке
    Enabled:   true,
    Headers:   []string{}, // Будут прочитаны автоматически
}
```

### Пример теста

```go
func TestMergeTestFiles(t *testing.T) {
    files := []string{
        "testdata/Повседневная обувь_04.11.2025.xlsx",
        "testdata/Повседневная обувь_04.11.2025 (1).xlsx",
    }
    
    reader := excel.NewReader()
    
    // Проверяем, что файлы читаются
    for _, file := range files {
        sheets, err := reader.GetSheetNames(file)
        assert.NoError(t, err)
        assert.NotEmpty(t, sheets)
        
        // Читаем заголовки из строки 5
        headers, err := reader.ReadHeaders(file, sheets[0], 5)
        assert.NoError(t, err)
        assert.NotEmpty(t, headers)
    }
    
    // Тест объединения
    merger := core.NewMerger(config)
    result, err := merger.MergeFiles(files)
    
    assert.NoError(t, err)
    assert.NotNil(t, result)
}
```

## Важные особенности

1. **Header Row = 4** - не забудьте указывать правильный номер строки
2. **Одинаковая структура** - оба файла имеют идентичную структуру столбцов
3. **Кириллица в именах** - проверяйте корректную работу с Unicode

## Добавление новых тестовых файлов

При необходимости добавьте свои тестовые файлы:

```bash
# Поместите файлы в testdata/
cp ~/Downloads/test_report.xlsx testdata/

# Убедитесь, что это .xlsx формат
file testdata/test_report.xlsx
# Должно показать: Microsoft Excel 2007+
```

### Рекомендации для тестовых файлов

- ✅ Используйте формат .xlsx (Excel 2007+)
- ✅ Создавайте файлы с одинаковой структурой для тестирования объединения
- ✅ Варьируйте положение заголовков (строка 1, 2, 5, и т.д.)
- ✅ Добавляйте файлы с разным количеством листов
- ✅ Включайте edge cases (пустые листы, один столбец, и т.д.)

## Git

Тестовые файлы **включены в репозиторий** для удобства тестирования.

Если файлы большие (>10 MB), добавьте в `.gitignore`:
```gitignore
# Большие тестовые файлы
testdata/*_large.xlsx
```
